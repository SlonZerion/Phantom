(function(define){var __define;"function"==typeof define&&define.amd&&(__define=define,define=null);
!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,o,n){Object.defineProperty(e,t,{get:o,set:n,enumerable:!0,configurable:!0})}var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},i={},r=o.parcelRequire1d24;null==r&&((r=function(e){if(e in n)return n[e].exports;if(e in i){var t=i[e];delete i[e];var o={id:e,exports:{}};return n[e]=o,t.call(o.exports,o,o.exports),o.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){i[e]=t},o.parcelRequire1d24=r),r.register("6tBWY",(function(o,n){t(o.exports,"removeSubdomainFromDomain",(function(){return w}),(function(e){return w=e})),t(o.exports,"detectPhishing",(function(){return A}),(function(e){return A=e}));var i=r("7f5sb"),l=r("dX6ZT"),s=r("beWYh"),a=r("HlEsU"),c=r("RVqnc"),u=r("lYEke"),d=r("7XqVB"),f=r("9CoSy"),h=function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function s(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,s)}a((n=n.apply(e,t||[])).next())}))};const p=6e5,y=(d.z.object({type:d.z.union([d.z.literal("all"),d.z.literal("blocklist"),d.z.literal("whitelist"),d.z.literal("error"),d.z.literal("fuzzy"),d.z.literal("blowfishBloomFilter")]),result:d.z.boolean(),source:d.z.optional(d.z.string()),match:d.z.string().optional(),isSubdomainDomainWhitelisted:d.z.boolean().optional()}),d.z.object({localHash:d.z.any()}),d.z.object({bitVector:d.z.string(),k:d.z.number(),hash:d.z.string(),bits:d.z.number(),salt:d.z.string()})),m=d.z.union([d.z.object({bloomFilter:y,bloomFilterHash:d.z.string(),recentlyAdded:d.z.array(d.z.string()),recentlyRemoved:d.z.array(d.z.string())}),d.z.object({bloomFilter:y.optional(),bloomFilterHash:d.z.optional(d.z.string()),recentlyAdded:d.z.array(d.z.string()),recentlyRemoved:d.z.array(d.z.string())})]),b=d.z.object({bloomFilter:y,lastUpdated:d.z.number()}).nullish(),g=d.z.object({recentlyAdded:d.z.array(d.z.string()),recentlyRemoved:d.z.array(d.z.string()),lastUpdated:d.z.number().optional()}).nullish();class z{check(t,o,n){if(!t)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};const i=w(t),r=S(i);if(B(r,this.whitelist)){const e=new URL(t).hostname;if(D(S(e),this.blocklist)){const t={type:"blocklist",result:!0,source:e,isSubdomainDomainWhitelisted:!0};return o&&n.capture("blockedDomain",{data:t}),t}return{type:"whitelist",result:!1,source:e,isSubdomainDomainWhitelisted:!0}}if(D(r,this.whitelist))return{type:"whitelist",result:!1,source:i,isSubdomainDomainWhitelisted:!1};if(D(r,this.blocklist)){const e={type:"blocklist",result:!0,source:i,isSubdomainDomainWhitelisted:!1};return o&&n.capture("blockedDomain",{data:e}),e}if(this.tolerance>0){let t=k(r);t=t.replace("www.","");const o=this.fuzzylist.find((o=>{const n=k(o);return e(u).get(t,n)<=this.tolerance}));if(o){return{type:"fuzzy",result:!0,match:C(o),source:i,isSubdomainDomainWhitelisted:!1}}}return{type:"all",result:!1,source:i,isSubdomainDomainWhitelisted:!1}}constructor(e,t,o,n){this.blocklist=v(e),this.whitelist=v(t),this.fuzzylist=v(o),this.tolerance=n||3}}const w=e=>{const t=new URL(e).hostname.split(".");return t.slice(0).slice(-(4===t.length?3:2)).join(".")},v=e=>e.map(S),S=e=>e.split(".").reverse(),C=e=>e.slice().reverse().join("."),k=e=>e.slice(1).reverse().join("."),D=(e,t)=>t.some((t=>!(t.length>e.length)&&t.every(((t,o)=>e[o]===t)))),B=(e,t)=>t.some((t=>t[0]===e[0]&&t[1]===e[1]&&"*"===t[2])),A=(e,t,o)=>h(void 0,void 0,void 0,(function*(){const n=(0,l.getBlocklist)(),i=yield e.get(a.StorageKeys.CachedBlocklistDiff),r=JSON.parse(`${i}`);let u,d,h,y;try{const e=yield(0,c.withTimeout)(t.getFeatureFlags(),1e3);u=!!e["kill-blowfish-blocklist"],d=!!e["enable-blocklist-metrics"],h=!!e["enable-blocklist-blowfish-logonly"],y=!!e["enable-http-wrapper"]}catch(e){u=!1,d=!0,h=!0,y=!1}if(r&&r.expiresAt&&r.expiresAt>Date.now()){const i=new z(n.blocklist.concat(r.blocklist),n.whitelist.concat(r.whitelist),n.fuzzylist.concat(r.fuzzylist)).check(o,d,t);return"all"!==i.type||u?i:F(o,d,h,y,e,t)}{const i={},c=(0,l.getVersion)();r&&(i.lastContentHash=`${r.contentHash}`),c&&(i.localBlocklistVersion=`${c}`);const m=new(0,s.RequestClient);m.withDefaultHeaders(i);const b=yield m.get(f.PHANTOM_BLOCKLIST_URL);if(200===b.status){const i=b.data;i.expiresAt=Date.now()+p,e.set(a.StorageKeys.CachedBlocklistDiff,JSON.stringify(i));const r=new z(n.blocklist.concat(i.blocklist),n.whitelist.concat(i.whitelist),n.fuzzylist.concat(i.fuzzylist)).check(o,d,t);return"all"!=r.type||u?r:F(o,d,h,y,e,t)}if(304===b.status){r.expiresAt=Date.now()+p,e.set(a.StorageKeys.CachedBlocklistDiff,JSON.stringify(r));const i=new z(n.blocklist.concat(r.blocklist),n.whitelist.concat(r.whitelist),n.fuzzylist.concat(r.fuzzylist)).check(o,d,t);return"all"!=i.type||u?i:F(o,d,h,y,e,t)}return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}}})),F=(e,t,o,n,r,l)=>h(void 0,void 0,void 0,(function*(){var n,c,u;if(!e)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};const d=w(e),h=yield r.getAll([a.StorageKeys.CachedBloomFilter,a.StorageKeys.CachedBloomFilterHash,a.StorageKeys.CachedScanDataRecents]),y=null!==(n=h[a.StorageKeys.CachedBloomFilter])&&void 0!==n?n:null,z=null!==(c=h[a.StorageKeys.CachedBloomFilterHash])&&void 0!==c?c:null,v=null!==(u=h[a.StorageKeys.CachedScanDataRecents])&&void 0!==u?u:null;let S=null,C={recentlyAdded:[],recentlyRemoved:[],lastUpdated:0};if(y){const e=b.safeParse(y);e.success?S=e.data:yield r.remove([a.StorageKeys.CachedBloomFilter,a.StorageKeys.CachedBloomFilterHash,a.StorageKeys.CachedScanDataRecents])}if(v){const e=g.safeParse(v);e.success?C=e.data:yield r.remove([a.StorageKeys.CachedBloomFilter,a.StorageKeys.CachedBloomFilterHash,a.StorageKeys.CachedScanDataRecents])}if(!C||null==C.lastUpdated||Date.now()>C.lastUpdated+p){const e={localHash:z},t=new(0,s.RequestClient)(!0),o=yield t.post(f.BLOWFISH_BLOOMFILTER_URL,e);if(200!==o.status)return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};const n=o.data;let i;const l=m.safeParse(n);if(!l.success)return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};i=l.data;const c={recentlyAdded:i.recentlyAdded,recentlyRemoved:i.recentlyRemoved,lastUpdated:Date.now()};if(yield r.set(a.StorageKeys.CachedScanDataRecents,c),C=c,null!=i.bloomFilter){const e={bloomFilter:i.bloomFilter,lastUpdated:Date.now()};yield Promise.all([r.set(a.StorageKeys.CachedBloomFilter,e),r.set(a.StorageKeys.CachedBloomFilterHash,i.bloomFilterHash)]),S=e}}if(!S)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};const k=(0,i.scanDomain)(S.bloomFilter,C.recentlyAdded,C.recentlyRemoved,e);if(k===i.Action.BLOCK){const e={result:!0,source:d,type:"blowfishBloomFilter"};return t&&l.capture("blockedDomain",{data:e}),o?{result:!1,type:"all",isSubdomainDomainWhitelisted:!1}:e}return k===i.Action.NONE?{result:!1,type:"all",isSubdomainDomainWhitelisted:!1}:{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}}))})),r.register("7f5sb",(function(o,n){t(o.exports,"Action",(function(){return a})),t(o.exports,"scanDomain",(function(){return u}));var i=r("1LpD3"),l=r("4FfQv"),s=r("8tcqI"),a=(e=>(e.BLOCK="BLOCK",e.NONE="NONE",e))(a||{});function c(t,o){for(let n=0;n<t.k;n++){const i=e(l)(`${t.salt}_${o}_${n}`,{asBytes:!0}),r=s.Buffer.from(i).subarray(0,4).readUInt32BE(0)%t.bits,a=Math.floor(r/24),c=r%24,u=c%8;if(0==(s.Buffer.from(t.bitVector.slice(4*a,4*a+4),"base64")[Math.floor(c/8)]&1<<7-u))return!1}return!0}"undefined"!=typeof self&&self.fetch&&self.fetch;function u(e,t,o,n){const i=new URL(n).hostname.toLowerCase().split(".");for(let n=0;n<i.length-1;n++){const r=i.slice(n).join(".");if(t.includes(r))return"BLOCK";if(c(e,r)&&!o.includes(r))return"BLOCK"}return"NONE"}})),r.register("4FfQv",(function(e,t){var o,n,i,l,s=r("8tcqI").Buffer;o=r("SGO3D"),n=r("hfc1Q").utf8,i=r("hfc1Q").bin,(l=function(e,t){var r=o.wordsToBytes(function(e){e.constructor==String?e=n.stringToBytes(e):void 0!==s&&"function"==typeof s.isBuffer&&s.isBuffer(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||(e=e.toString());var t=o.bytesToWords(e),i=8*e.length,r=[],l=1732584193,a=-271733879,c=-1732584194,u=271733878,d=-1009589776;t[i>>5]|=128<<24-i%32,t[15+(i+64>>>9<<4)]=i;for(var f=0;f<t.length;f+=16){for(var h=l,p=a,y=c,m=u,b=d,g=0;g<80;g++){if(g<16)r[g]=t[f+g];else{var z=r[g-3]^r[g-8]^r[g-14]^r[g-16];r[g]=z<<1|z>>>31}var w=(l<<5|l>>>27)+d+(r[g]>>>0)+(g<20?1518500249+(a&c|~a&u):g<40?1859775393+(a^c^u):g<60?(a&c|a&u|c&u)-1894007588:(a^c^u)-899497514);d=u,u=c,c=a<<30|a>>>2,a=l,l=w}l+=h,a+=p,c+=y,u+=m,d+=b}return[l,a,c,u,d]}(e));return t&&t.asBytes?r:t&&t.asString?i.bytesToString(r):o.bytesToHex(r)})._blocksize=16,l._digestsize=20,e.exports=l})),r.register("dX6ZT",(function(e,o){var n,i;t(e.exports,"getVersion",(function(){return n}),(function(e){return n=e})),t(e.exports,"getBlocklist",(function(){return i}),(function(e){return i=e}));var l=r("hqGpV").version,s=r("3CIKc");n=()=>l,i=()=>s})),r.register("hqGpV",(function(e,t){e.exports=JSON.parse('{"name":"@phantom-labs/blocklist","version":"0.13.0","main":"index.js","types":"index.d.ts","repository":"git@github.com:phantom-labs/blocklist.git","author":"Jordan Leigh <AlwaysBCoding@gmail.com>","license":"MIT","scripts":{"build":"node build.js"},"dependencies":{"js-yaml":"^4.1.0","sha3":"^2.1.4"}}')})),r.register("3CIKc",(function(e,t){e.exports=JSON.parse('{"blocklist":["phantomweb.app","aurory.app","solvision.io","staratlas.art","starsatlas.com","sollet.cc","raydlum.io","aurorynft.com","sneks.gg","solletweb.io","i-sollet.com","fancyfrenchienft.art","solanawebwallet.online","phahtom.com","server-syncwallet.com","staratias.app","raydium.network","grapesnetwork.me","staratias.art","soistarter.org","audius-nft.top","aurory.me","degenapes.app","phantom-app.online","phantomwallet.net","dapps-node.com","phantom-app.link","solanaoutage.com","walletconnectdapps.net","staratlas.cx","web-phantom.app","0120tt.com"],"whitelist":[],"fuzzylist":[],"contentHash":"830ea1c9a833213eabc17990adf053081f503b1203ca9a2c711db7199e657293"}')})),r.register("lYEke",(function(e,t){!function(){"use strict";var o;try{o="undefined"!=typeof Intl&&void 0!==Intl.Collator?Intl.Collator("generic",{sensitivity:"base"}):null}catch(e){console.log("Collator could not be initialized and wouldn't be used")}var n=r("70tAE"),i=[],l=[],s={get:function(e,t,r){if(r&&o&&r.useCollator){var s,a,c,u,d,f,h=e.length,p=t.length;if(0===h)return p;if(0===p)return h;for(c=0;c<p;++c)i[c]=c,l[c]=t.charCodeAt(c);for(i[p]=p,c=0;c<h;++c){for(a=c+1,u=0;u<p;++u)s=a,f=0===o.compare(e.charAt(c),String.fromCharCode(l[u])),(a=i[u]+(f?0:1))>(d=s+1)&&(a=d),a>(d=i[u+1]+1)&&(a=d),i[u]=s;i[u]=a}return a}return n.distance(e,t)}};"undefined"!=typeof define&&null!==define&&define.amd?define((function(){return s})):null!==e&&e.exports===t?e.exports=s:"undefined"!=typeof self&&"function"==typeof self.postMessage&&"function"==typeof self.importScripts?self.Levenshtein=s:"undefined"!=typeof window&&null!==window&&(window.Levenshtein=s)}()})),r.register("70tAE",(function(e,o){t(e.exports,"distance",(function(){return i})),t(e.exports,"closest",(function(){return r}));const n=new Uint32Array(65536),i=(e,t)=>{if(e.length<t.length){const o=t;t=e,e=o}return 0===t.length?e.length:e.length<=32?((e,t)=>{const o=e.length,i=t.length,r=1<<o-1;let l=-1,s=0,a=o,c=o;for(;c--;)n[e.charCodeAt(c)]|=1<<c;for(c=0;c<i;c++){let e=n[t.charCodeAt(c)];const o=e|s;e|=(e&l)+l^l,s|=~(e|l),l&=e,s&r&&a++,l&r&&a--,s=s<<1|1,l=l<<1|~(o|s),s&=o}for(c=o;c--;)n[e.charCodeAt(c)]=0;return a})(e,t):((e,t)=>{const o=t.length,i=e.length,r=[],l=[],s=Math.ceil(o/32),a=Math.ceil(i/32);for(let e=0;e<s;e++)l[e]=-1,r[e]=0;let c=0;for(;c<a-1;c++){let s=0,a=-1;const u=32*c,d=Math.min(32,i)+u;for(let t=u;t<d;t++)n[e.charCodeAt(t)]|=1<<t;for(let e=0;e<o;e++){const o=n[t.charCodeAt(e)],i=l[e/32|0]>>>e&1,c=r[e/32|0]>>>e&1,u=o|s,d=((o|c)&a)+a^a|o|c;let f=s|~(d|a),h=a&d;f>>>31^i&&(l[e/32|0]^=1<<e),h>>>31^c&&(r[e/32|0]^=1<<e),f=f<<1|i,h=h<<1|c,a=h|~(u|f),s=f&u}for(let t=u;t<d;t++)n[e.charCodeAt(t)]=0}let u=0,d=-1;const f=32*c,h=Math.min(32,i-f)+f;for(let t=f;t<h;t++)n[e.charCodeAt(t)]|=1<<t;let p=i;for(let e=0;e<o;e++){const o=n[t.charCodeAt(e)],s=l[e/32|0]>>>e&1,a=r[e/32|0]>>>e&1,c=o|u,f=((o|a)&d)+d^d|o|a;let h=u|~(f|d),y=d&f;p+=h>>>i-1&1,p-=y>>>i-1&1,h>>>31^s&&(l[e/32|0]^=1<<e),y>>>31^a&&(r[e/32|0]^=1<<e),h=h<<1|s,y=y<<1|a,d=y|~(c|h),u=h&c}for(let t=f;t<h;t++)n[e.charCodeAt(t)]=0;return p})(e,t)},r=(e,t)=>{let o=1/0,n=0;for(let r=0;r<t.length;r++){const l=i(e,t[r]);l<o&&(o=l,n=r)}return t[n]}}))}();
//# sourceMappingURL=phishing.ef2b6270.js.map
define=__define;})(window.define);